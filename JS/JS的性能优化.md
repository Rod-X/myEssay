# 内存管理
+ 避免不必要的Bug
+ 内存:由可读写单元组成,表示一片可操作空间
+ 管理:人为的去操作一片空间的申请,使用和释放
+ 内存管理:开发者主动申请空间,使用空间,释放空间
+ 管理流程:申请-使用-释放

## 垃圾回收
+ 自动的垃圾回收
+ 对象为不可达对象就是垃圾
+ 对象不能从根上访问到就是垃圾
+ 可达对象:能访问到的对象(引用,作用域)
+ 可达对象的标准就是从根出发的,就是从全局区访问到的

## GC算法
+ GC垃圾回收机制的简写
+ GC的垃圾是什么
  - 程序中不再使用的对象
  - 程序中不能访问的对象

+ 引用计数
+ 标记清除
+ 标记整理
+ 分代回收

## 引用计数算法
+ 设置引用数,判断当前引用是否为0
+ 引用计数器
+ 引用关系发生改变时,计数器发生改变
  - 每给一个变量赋值,引用加一
  - 当引用被修改,引用减一
+ 引用数字为0时立即回收
+ 优点
  - 发现垃圾立即回收
  - 最大限度减少程序暂停
+ 缺点
  - 无法回收循环引用对象
  - 时间开销大

## 标记清除
+ 分标记和清除两个阶段完成
+ 遍历所有对象找标记活动对象--从global出发的可达对象标记
+ 遍历所有对象清除没有标记对象--未标记的对象为不可达对象-垃圾
+ 回收相应空间
+ 优点
  - 可以清除循环引用
+ 缺点
  - 地址不连续,内存不能完全分配,造成空间碎片化,回收多了少了,
  - 回收空间不能最大化使用

## 标记整理算法
+ 标记整理时标签清除的增强
+ 标记阶段的操作和标记清除一致
+ 清除阶段会先执行整理,移动对象位置

## 常见 GC 算法内容总结
+ 引用计数
  - 可以立即回收垃圾
  - 可以最大限度使用空间
  - 性能销毁大
  - 无法清除循环引用
+ 标记清除
  - 可以回收循环引用
  - 容易产生碎片化空间,浪费空间
  - 不会立即回收垃圾对象
+ 标记整理
  - 减少碎片化空间
  - 不会立即回收

## V8 引擎
+ V8主流的javascript引擎
+ V8采用即使编译
+ V8内存设限
  - win64 1.5G
  - win32 800M
+ V8垃圾回收策略
  - 分代回收思想
  - 内存分为新生代和老生代
  - 常用的GC-分代回收-空间复制-标记清除-标记整理-标记增量
+ V8新生代垃圾回收机制
  - 内部把空间一分为二(from - to)(wind64 32M | win32 16M)
  - 小空间用于存储新生代代对象-新生代对象是值存活时间较短的对象
  - 回收采复制算法+标记整理
  - 使用空间为from空间,空闲空间为to空间
  - 活动对象存储与from空间
  - 标记整理后复制到to空间
  - from释放再 和to空间交换 
  - 拷贝过程中存在晋升操作,经过一轮的回收后还存在的对象会晋升老生代对象
  - To空间使用率超过25%

+ V8老生代对象回收
  - 内存 (1.4G | 700M)
  - 老生代对象存活时间较长的对象
  - 主要采用标记清除,标记整理,标记增量
  - 主要使用标记清除完成垃圾空间的回收
  - 采用标记整理进行空间优化(新生代晋升时进行判断是否整理)
  - 新生代时使用空间换时间的算法
  - 垃圾回收会阻塞js程序进程
  - 增量标记,不短标记,当量达到一定时,进行垃圾回收

## 为什么使用Performance
+ 提供更多的内存空间的监控
## performance使用步骤
+ 打卡浏览器输入目标网址
+ 打卡performance面包
+ 点开录制
+ 执行一定的用户行为后进行停止
+ 点击内存选项,平稳说明问题不大
+ 陡峭需要分析原因

## 内存问题的体现
+ 业务出现延迟加载或者经常性暂停(频繁的垃圾回收出现)
+ 页面持续性出现糟糕的性能(性能膨胀,浏览器不合理的申请性能)
+ 页面的性能随时间延长越来越差(性能泄露)

## 界定内存问题的标准
+ 内存泄漏:内存使用持续升高
+ 内存膨胀:在多数设备上都存在性能问题
+ 频繁的垃圾回收:通过内存变化图进行分析

## 监控内存的几种方式
+ 浏览器任务管理器
  - 看到当前进程的 脚本的内存
  - 一直增加没有减少
+ TimeLine时序图记录
  - 看到内存走势判断
+ 堆快照查找分离Dom
  - 分离Dom - 界面元素存活再度Dom树上 - 垃圾对象时的Dom节点 - 分离状态的Dom节点
  - 可能由dom引起的内存泄露-存在内存而不是界面元素
+ 判断是否处有频繁的垃圾回收
  - 瞬间上下,就是频繁的垃圾回收
  - 会阻塞js的

## V8引擎工作流程
+ 全量解析
  - 解析被使用的代码
  - 生成AST
  - 构建具体scopes信息,变量引用,声明
  - 抛出所有语法错误
+ 预解析
  - 声明未调用-函数声明

##  堆栈操作
+ JS执行环境
+ 执行环境栈
+ 执行上下文
+ VO(G),全局变量对象


## jsBench.Me测试你的js速度
